!function(f){"use strict";window.bhfb={init:function(){this.builderGridContentFlag=!1,this.updateGridDelay=200,this.currentDevice="desktop",this.currentArea="header",this.currentRowInput="",this.currentRow="",this.currentColumn="",this.currentColumnPos="",this.currentComponent="",this.currentBuilder="",this.currentBuilderType="",this.componentsOrder="",this.customizeNavigation(),this.elementsPopup(),this.elementsButton(),this.storeGlobals(),this.devicesSwitcher(),this.elementsPopupContent(),this.builderGridContent(),this.elementsSortable(),this.builderCustomColumns(),this.footerCustomizerOptions(),this.showHideBuilder(),this.showHideBuilderTop()},jsonDecode:function(o){return JSON.parse(o.replace(/'/g,'"').replace(";",""))},customizeNavigation:function(){const e=["sub-accordion-section-botiga_section_hb_above_header_row","sub-accordion-section-botiga_section_hb_main_header_row","sub-accordion-section-botiga_section_hb_below_header_row","sub-accordion-section-botiga_section_hb_mobile_offcanvas","sub-accordion-section-botiga_section_hb_component__logo","sub-accordion-section-botiga_section_hb_component__search","sub-accordion-section-botiga_section_hb_component__social","sub-accordion-section-botiga_section_hb_component__menu","sub-accordion-section-botiga_section_hb_component__secondary_menu","sub-accordion-section-botiga_section_hb_component__contact_info","sub-accordion-section-botiga_section_hb_component__button","sub-accordion-section-botiga_section_hb_component__button2","sub-accordion-section-botiga_section_hb_component__html","sub-accordion-section-botiga_section_hb_component__html2","sub-accordion-section-botiga_section_hb_component__shortcode","sub-accordion-section-botiga_section_hb_component__botiga_pro_hb_login_register","sub-accordion-section-botiga_section_hb_component__woo_icons","sub-accordion-section-botiga_section_hb_component__pll_switcher","sub-accordion-section-botiga_section_hb_component__wpml_switcher","sub-accordion-section-botiga_section_hb_component__mobile_offcanvas_menu","sub-accordion-section-botiga_section_hb_component__mobile_hamburger","sub-accordion-section-botiga_section_fb_above_footer_row","sub-accordion-section-botiga_section_fb_main_footer_row","sub-accordion-section-botiga_section_fb_below_footer_row","sub-accordion-section-botiga_section_fb_component__footer_menu","sub-accordion-section-botiga_section_fb_component__copyright","sub-accordion-section-botiga_section_fb_component__social","sub-accordion-section-botiga_section_fb_component__button","sub-accordion-section-botiga_section_fb_component__button2","sub-accordion-section-botiga_section_fb_component__html","sub-accordion-section-botiga_section_fb_component__html2","sub-accordion-section-botiga_section_fb_component__shortcode","sub-accordion-section-botiga_section_fb_component__widget1","sub-accordion-section-botiga_section_fb_component__widget2","sub-accordion-section-botiga_section_fb_component__widget3","sub-accordion-section-botiga_section_fb_component__widget4"];let t="";f(document).on("mouseover focus",".customize-section-back",function(o){t=f(".control-section.open").attr("id")}),f(document).on("click keydown",".customize-section-back",function(o){e.includes(t)&&(-1!==t.indexOf("_hb_")?wp.customize.section("botiga_section_hb_wrapper"):wp.customize.section("botiga_section_fb_wrapper")).focus()})},storeGlobals:function(){const e=this;f(" .wp-full-overlay-footer .devices button, .botiga-devices-preview button").on("click",function(){let o=f(this).attr("data-device");"tablet"===o&&(o="mobile"),"footer"===e.currentBuilderType&&(o="desktop"),e.currentDevice=o,e.builderGridContent()}),f(document).on("click mouseover",".botiga-bhfb-area",function(o){e.currentRowInput=f("#_customize-input-botiga_"+e.currentBuilderType+"_row__"+f(this).data("bhfb-row")),e.currentRow=f(this).closest(".botiga-bhfb-row"),e.currentColumnPos=f(this).index()-1,e.currentColumn=f(this),!e.currentRow.length&&f(this).hasClass("botiga-bhfb-area-offcanvas")&&(e.currentRowInput=f("#_customize-input-botiga_header_row__mobile_offcanvas"),e.currentRow=f(".botiga-bhfb-area-offcanvas"),e.currentColumnPos=f(this).index())}),f(document).on("click mouseover",".bhfb-button",function(o){e.currentComponent=f(this).data("bhfb-id")})},devicesSwitcher:function(){f(" .wp-full-overlay-footer .devices button, .botiga-devices-preview button").on("click",function(){var o=f(this).attr("data-device");"mobile"===o&&(o="tablet"),f(".botiga-bhfb-devices .botiga-bhfb-device-link").removeClass("active"),f('.botiga-bhfb-devices .botiga-bhfb-device-link[data-device="'+o+'"]').addClass("active")}),f(".botiga-bhfb-devices .botiga-bhfb-device-link").on("click",function(o){o.preventDefault();o=f(this).attr("data-device");f(' .wp-full-overlay-footer .devices button[data-device="'+o+'"]').trigger("click")})},getElementsUnused:function(){var o;let e=botiga_hfb.components.desktop,t=botiga_hfb.components.mobile,n=["#_customize-input-botiga_header_row__above_header_row","#_customize-input-botiga_header_row__main_header_row","#_customize-input-botiga_header_row__below_header_row","#_customize-input-botiga_header_row__mobile_offcanvas"];"footer"===this.currentBuilderType&&(e=botiga_hfb.components.footer,n=["#_customize-input-botiga_footer_row__above_footer_row","#_customize-input-botiga_footer_row__main_footer_row","#_customize-input-botiga_footer_row__below_footer_row"]);for(o of n){for(var i of e){var b=this.jsonDecode(f(o).val());if(b.desktop.length)for(const c of b.desktop)e=e.filter(o=>!c.includes(o.id))}for(var i of t){var r=this.jsonDecode(f(o).val());if(r.mobile.length)for(const a of r.mobile)t=t.filter(o=>!a.includes(o.id));if(-1!==o.indexOf("row__mobile_offcanvas")&&r.mobile_offcanvas.length)for(const s of r.mobile_offcanvas)t=t.filter(o=>!s.includes(o.id))}}return{desktop:e,mobile:t}},elementsPopup:function(){const i=this;f(document).on("click",".botiga-bhfb-area",function(o){const e=i.currentBuilder.find("#botiga-bhfb-elements"),t=f(this)[0].getBoundingClientRect(),n=f(this).data("bhfb-row");setTimeout(function(){return e.css("top",0),e.css("left",t.left),e.css("top",t.top-(e.height()+50)),i.isElementInViewport(e)?(e.css("left",t.left),e.css("right","auto")):(e.css("left","auto"),e.css("right",25)),!o.target.classList.contains("bhfb-remove-element")&&!o.target.classList.contains("bhfb-button")&&void e.addClass("show")},200),i.elementsPopupContent(n),i.builderGridContent()}),f(document).on("mouseup",function(o){const e=i.currentBuilder.find("#botiga-bhfb-elements");null===o.target.closest("#botiga-bhfb-elements")&&e.removeClass("show")})},isElementInViewport:function(o){o=(o="function"==typeof jQuery&&o instanceof jQuery?o[0]:o).getBoundingClientRect();return 0<=o.top&&0<=o.left&&o.bottom<=(window.innerHeight||f(window).height())&&o.right<=(window.innerWidth||f(window).width())},elementsPopupContent:function(o=""){const e=this.getElementsUnused(),t=f(".botiga-bhfb-elements-desktop"),n=f(".botiga-bhfb-elements-mobile");if(t.html(""),n.html(""),e.desktop.length)for(const i of e.desktop)t.append('<div class="botiga-bhfb-element botiga-bhfb-element-desktop"><a href="#" class="bhfb-button" data-bhfb-id="'+i.id+'">'+i.label+"</a></div>");else t.append('<p class="bhfb-elements-message">'+botiga_hfb.i18n.elementsMessage+"</p>");if(e.mobile="mobile_offcanvas"!==o?e.mobile.filter(o=>"mobile_offcanvas_menu"!==o.id):e.mobile.filter(o=>"secondary_menu"!==o.id&&"mobile_hamburger"!==o.id),e.mobile.length)for(const b of e.mobile)n.append('<div class="botiga-bhfb-element botiga-bhfb-element-mobile"><a href="#" class="bhfb-button" data-bhfb-id="'+b.id+'">'+b.label+"</a></div>");else n.append('<p class="bhfb-elements-message">'+botiga_hfb.i18n.elementsMessage+"</p>")},elementsButton:function(){const n=this;f(document).on("click",".botiga-bhfb-element > a",function(o){o.preventDefault();const e=f(this).data("bhfb-id"),t=f(this).data("bhfb-focus-section");if(f(this).closest("#botiga-bhfb-elements").length)n.elementsButtonAdd(e);else if(o.target.classList.contains("bhfb-remove-element"))return n.elementsButtonRemove(e),!1;setTimeout(function(){wp.customize.section(t).focus()},n.updateGridDelay)})},elementsButtonAdd:function(o,e=!1){var t=this;let n=t.jsonDecode(t.currentRowInput.val()),i=t.currentDevice;return"mobile"===t.currentDevice&&t.currentRow.hasClass("botiga-bhfb-area-offcanvas")&&(i="mobile_offcanvas"),e?n[i][t.currentColumnPos]=t.componentsOrder:n[i][t.currentColumnPos].push(o),!("mobile_offcanvas_menu"===t.currentComponent&&!t.currentRow.hasClass("botiga-bhfb-area-offcanvas"))&&(("mobile_hamburger"!==t.currentComponent||!t.currentRow.hasClass("botiga-bhfb-area-offcanvas"))&&(t.currentRowInput.val(JSON.stringify(n)),t.currentRowInput.trigger("change"),"header"===t.currentBuilderType&&t.currentRowInput.closest(".customize-control").next().find("input").val(Math.random()).trigger("change"),t.elementsPopupContent(),t.builderGridContent(),void f("#botiga-bhfb-elements").removeClass("show")))},elementsButtonRemove:function(e,o=!0){var t=this;let n=t.jsonDecode(t.currentRowInput.val()),i=t.currentDevice;"mobile"===t.currentDevice&&t.currentRow.hasClass("botiga-bhfb-area-offcanvas")&&(i="mobile_offcanvas"),n[i][t.currentColumnPos]=n[i][t.currentColumnPos].filter(o=>o!==e),t.currentRowInput.val(JSON.stringify(n)),o&&(t.currentRowInput.trigger("change"),t.currentRowInput.closest(".customize-control").next().find("input").val(Math.random()).trigger("change")),t.elementsPopupContent(),t.builderGridContent()},elementsSortable:function(){const c=this;f(".botiga-bhfb-area").each(function(){f(this).sortable({placeholder:"botiga-bhfb-element bhfb-ui-state-highlight",connectWith:".botiga-bhfb-area",change:function(o,e){c.currentRow=f(e.placeholder[0]).closest(".botiga-bhfb-row").length?f(e.placeholder[0]).closest(".botiga-bhfb-row"):f(e.placeholder[0]).closest(".botiga-bhfb-area-offcanvas"),c.currentRowInput=f("#_customize-input-botiga_"+c.currentBuilderType+"_row__"+e.placeholder.closest(".botiga-bhfb-area").data("bhfb-row"));let t=[];e.placeholder.closest(".botiga-bhfb-area").find(".ui-sortable-placeholder").attr("data-bhfb-id",c.currentComponent),e.placeholder.closest(".botiga-bhfb-area").find(".botiga-bhfb-element").each(function(){var o=(void 0!==f(this).find(".bhfb-button").data("bhfb-id")?f(this).find(".bhfb-button"):f(this)).data("bhfb-id");f(this).hasClass("ui-sortable-helper")||t.push(o)}),c.componentsOrder=t},update:function(o,e){if(this===e.item.parent()[0]){var t=e.item.find("> .bhfb-button").data("bhfb-id"),n=e.item.closest(".botiga-bhfb-area").data("bhfb-row"),i=e.item.closest(".botiga-bhfb-area").index()-1,b=null!==e.sender?e.sender.data("bhfb-row"):null,r=null!==e.sender?e.sender.index()-1:null;if(null===e.sender)return c.elementsButtonAdd("",!0),!1;c.currentRowInput=f("#_customize-input-botiga_"+c.currentBuilderType+"_row__"+b),c.currentColumnPos=r,c.elementsButtonRemove(t,!0),c.currentRowInput=f("#_customize-input-botiga_"+c.currentBuilderType+"_row__"+n),c.currentColumnPos=i,c.elementsButtonAdd(t,!0)}}}),f(this).disableSelection()})},builderGridContent:function(){let _=this,o=["#_customize-input-botiga_header_row__above_header_row","#_customize-input-botiga_header_row__main_header_row","#_customize-input-botiga_header_row__below_header_row","#_customize-input-botiga_header_row__mobile_offcanvas"],u="hb";if(_.currentBuilderType&&"footer"===_.currentBuilderType&&(o=["#_customize-input-botiga_footer_row__above_footer_row","#_customize-input-botiga_footer_row__main_footer_row","#_customize-input-botiga_footer_row__below_footer_row"],u="fb"),_.builderGridContentFlag)return!1;_.builderGridContentFlag=!0,setTimeout(function(){for(var e of o){var t,n=_.jsonDecode(f(e).val());let o="";if(-1!==e.indexOf("above_"+_.currentBuilderType+"_row")&&(o="above"),-1!==e.indexOf("main_"+_.currentBuilderType+"_row")&&(o="main"),-1!==e.indexOf("below_"+_.currentBuilderType+"_row")&&(o="below"),-1!==e.indexOf("row__mobile_offcanvas")&&(o="mobile_offcanvas"),f('.botiga-bhfb-area[data-bhfb-row="'+o+"_"+_.currentBuilderType+'_row"]').each(function(){f(this).remove()}),"desktop"===_.currentDevice)for(const r of n.desktop){f(".botiga-bhfb-"+_.currentBuilderType+" .botiga-bhfb-"+o+"-row").append('<div class="botiga-bhfb-area" data-bhfb-row="'+o+"_"+_.currentBuilderType+'_row">');const c=f(".botiga-bhfb-"+o+"-row").find(".botiga-bhfb-area:last-child");if(r.length)for(var i of r)i=_.getElementData(i),c.append('<div class="botiga-bhfb-element"><a href="#" class="bhfb-button" data-bhfb-id="'+i.id+'" data-bhfb-focus-section="botiga_section_'+u+"_component__"+i.id+'">'+i.label+'<i class="bhfb-remove-element dashicons dashicons-no-alt"></i></a></div>')}if("mobile"===_.currentDevice){for(const a of n.mobile){f(".botiga-bhfb-"+o+"-row").append('<div class="botiga-bhfb-area" data-bhfb-row="'+o+"_"+_.currentBuilderType+'_row">');const s=f(".botiga-bhfb-"+o+"-row").find(".botiga-bhfb-area:last-child");if(a.length)for(var b of a)b=_.getElementData(b),s.append('<div class="botiga-bhfb-element"><a href="#" class="bhfb-button" data-bhfb-id="'+b.id+'" data-bhfb-focus-section="botiga_section_'+u+"_component__"+b.id+'">'+b.label+'<i class="bhfb-remove-element dashicons dashicons-no-alt"></i></a></div>')}if(-1!==e.indexOf("mobile_offcanvas"))if(f(".botiga-bhfb-area-offcanvas").html(""),n.mobile_offcanvas.length)for(t of n.mobile_offcanvas[0])t=_.getElementData(t),f(".botiga-bhfb-area-offcanvas").append('<div class="botiga-bhfb-element"><a href="#" class="bhfb-button" data-bhfb-id="'+t.id+'" data-bhfb-focus-section="botiga_section_hb_component__'+t.id+'">'+t.label+'<i class="bhfb-remove-element dashicons dashicons-no-alt"></i></a></div>')}}if(!_.currentBuilder)return _.builderGridContentFlag=!1;_.currentBuilder.hasClass("show")&&!_.currentBuilder.hasClass("show-bottom")?(f(".botiga-bhfb").css("height",0),_.currentBuilder.css("height",_.currentBuilder.find(".botiga-bhfb-top").outerHeight()+47)):_.currentBuilder.css("height",0),_.elementsSortable(),f(window).trigger("bhfb.grid.ready"),_.builderGridContentFlag=!1},_.updateGridDelay)},getElementData:function(o){var e;let t=[...botiga_hfb.components.desktop,...botiga_hfb.components.mobile];"footer"===this.currentBuilderType&&(t=botiga_hfb.components.footer);for(e of t)if(e.id===o)return e;return""},showHideBuilder:function(){const t=this;["botiga_section_hb_wrapper","botiga_section_hb_above_header_row","botiga_section_hb_main_header_row","botiga_section_hb_below_header_row","botiga_section_hb_mobile_offcanvas","botiga_section_hb_component__logo","botiga_section_hb_component__search","botiga_section_hb_component__social","botiga_section_hb_component__menu","botiga_section_hb_component__secondary_menu","botiga_section_hb_component__contact_info","botiga_section_hb_component__button","botiga_section_hb_component__button2","botiga_section_hb_component__html","botiga_section_hb_component__html2","botiga_section_hb_component__shortcode","botiga_section_hb_component__botiga_pro_hb_login_register","botiga_section_hb_component__woo_icons","botiga_section_hb_component__pll_switcher","botiga_section_hb_component__wpml_switcher","botiga_section_hb_component__mobile_offcanvas_menu","botiga_section_hb_component__mobile_hamburger","botiga_section_fb_wrapper","botiga_section_fb_above_footer_row","botiga_section_fb_main_footer_row","botiga_section_fb_below_footer_row","botiga_section_fb_component__social","botiga_section_fb_component__footer_menu","botiga_section_fb_component__copyright","botiga_section_fb_component__button","botiga_section_fb_component__button2","botiga_section_fb_component__html","botiga_section_fb_component__html2","botiga_section_fb_component__shortcode","botiga_section_fb_component__widget1","botiga_section_fb_component__widget2","botiga_section_fb_component__widget3","botiga_section_fb_component__widget4"].forEach(function(e){void 0!==wp.customize.section(e)&&wp.customize.section(e).expanded.bind(function(o){t.currentBuilder=t.getCurrentBuilderByComponent(e),t.currentBuilderType=t.currentBuilder.hasClass("botiga-bhfb-header")?"header":"footer",o?(f("body").addClass("bhfb-active"),t.currentBuilder.addClass("show")):(f("body").removeClass("bhfb-active"),t.currentBuilder.removeClass("show")),setTimeout(function(){t.builderGridContent()},100)})})},getCurrentBuilderByComponent:function(o){return-1!==o.indexOf("_hb_")?f(".botiga-bhfb-header"):-1!==o.indexOf("_fb_")&&f(".botiga-bhfb-footer")},showHideBuilderTop:function(){const e=this;f(".botiga-bhfb-bottom-display").on("click",function(o){o.preventDefault(),f("body").toggleClass("bhfb-active-bottom"),f(this).toggleClass("show"),f(".botiga-bhfb-top").toggleClass("show"),f(".botiga-bhfb").toggleClass("show-bottom"),e.builderGridContent()})},builderCustomColumns:function(){const b=this;["botiga_footer_row__above_footer_row_columns","botiga_footer_row__main_footer_row_columns","botiga_footer_row__below_footer_row_columns"].forEach(function(i){void 0!==wp.customize.control(i)&&wp.customize(i,function(o){o.bind(function(o){let e="",t="";if(-1!==i.indexOf("botiga_footer_row__above_footer")&&(e="botiga-bhfb-above-row",t=f("#_customize-input-botiga_footer_row__above_footer_row")),-1!==i.indexOf("botiga_footer_row__main_footer")&&(e="botiga-bhfb-main-row",t=f("#_customize-input-botiga_footer_row__main_footer_row")),-1!==i.indexOf("botiga_footer_row__below_footer")&&(e="botiga-bhfb-below-row",t=f("#_customize-input-botiga_footer_row__below_footer_row")),""===e)return!1;for(let o=1;o<=6;o++)f(".botiga-bhfb-footer .botiga-bhfb-row."+e).removeClass("botiga-bhfb-row-"+o+"-columns");f(".botiga-bhfb-footer .botiga-bhfb-row."+e).addClass("botiga-bhfb-row-"+o+"-columns");let n=b.jsonDecode(t.val());if(o<n[b.currentDevice].length)for(;n[b.currentDevice].length>o;)n[b.currentDevice].pop();else if(o>n[b.currentDevice].length)for(;n[b.currentDevice].length<o;)n[b.currentDevice].push([]);t.val(JSON.stringify(n)),t.trigger("change"),b.builderGridContent()})})})},footerCustomizerOptions:function(){for(const e of["above","main","below"]){var o="botiga_footer_row__"+e+"_footer_row";wp.customize(o,function(o){o.bind(function(o){f(".bhfb-footer").remove()})})}}},f(document).ready(function(){bhfb.init()})}(jQuery);