"use strict";var botiga=botiga||{};botiga.ajaxSearch={ajax:function(e,a,t,r){var n;(n=new XMLHttpRequest).open("POST",botiga.ajaxurl,!0),n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n.onload=function(){200<=this.status&&this.status<400&&r.apply(this)};var o="";t=Object.entries(t);for(var s=0;s<t.length;s++)o+="&"+t[s].join("=");n.send("action="+e+"&nonce="+a+o)},init:function(){var a=this,t=this,r=document.querySelectorAll(".wc-search-field, .wc-block-product-search__field");if(r.length){for(var e=0;e<r.length;e++)!function(e){r[e].setAttribute("autocomplete","off"),r[e].addEventListener("keyup",a.debounce(function(){t.searchFormHandler(r[e])},300)),r[e].addEventListener("focus",a.debounce(function(){t.searchFormHandler(r[e])},300))}(e);document.addEventListener("click",function(e){null===e.target.closest(".botiga-ajax-search__wrapper")&&t.destroy()})}},searchFormHandler:function(t){if(t.value.length<3)return!1;var r=this,e=t.value,a=t.classList,a=a.contains("wc-block-product-search__field")||a.contains("wc-search-field")?"product":"post";r.ajax("botiga_ajax_search_callback",botiga_ajax_search.nonce,{search_term:e,type:a,posts_per_page:botiga_ajax_search.query_args.posts_per_page,order:botiga_ajax_search.query_args.order,orderby:botiga_ajax_search.query_args.orderby,show_categories:botiga_ajax_search.query_args.show_categories},function(){var e=JSON.parse(this.response),a=t.parentNode.getElementsByClassName("botiga-ajax-search__wrapper")[0];void 0===a&&((a=document.createElement("div")).className="botiga-ajax-search__wrapper",t.parentNode.append(a),t.parentNode.classList.add("botiga-ajax-search")),a.innerHTML=e.output;e=document.querySelector(".botiga-ajax-search-products");null!==e&&r.scrollbarVisible(e)&&e.classList.add("has-scrollbar"),r.elementIsOutOfScreenHorizontal(a)&&a.classList.add("reverse"),window.dispatchEvent(new Event("botiga.ajax.search.results.loaded"))})},destroy:function(){var e=document.querySelectorAll(".botiga-ajax-search__wrapper");if(e.length)for(var a=0;a<e.length;a++)e[a].remove()},debounce:function(r,n){var o=null;return function(){for(var e=arguments.length,a=new Array(e),t=0;t<e;t++)a[t]=arguments[t];window.clearTimeout(o),o=window.setTimeout(function(){r.apply(null,a)},n)}},scrollbarVisible:function(e){return e.scrollHeight>e.clientHeight},elementIsOutOfScreenHorizontal:function(e){e=e.getBoundingClientRect();return e.x+e.width>window.innerWidth}},jQuery(document).ready(function(){botiga.ajaxSearch.init()});